<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.7.79" DotMatrixReport="False" IniFile="\Software\Fast Reports" OldStyleProgress="True" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="39885,6569446181" ReportOptions.Description.Text="" ReportOptions.LastChange="39900,4057095255" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  CalendarStartDate: TDateTime;&#13;&#10;  DayLeft,DayTop,DayWidth,DayHeight,DayTaskCount: Extended;&#13;&#10;&#13;&#10;function StartOfTheMonth(const AValue: TDateTime): TDateTime;&#13;&#10;var&#13;&#10;  LYear, LMonth, LDay: Word;&#13;&#10;begin&#13;&#10;  DecodeDate(AValue, LYear, LMonth, LDay);&#13;&#10;  Result := EncodeDate(LYear, LMonth, 1);&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CalendarOnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  Row: Integer;&#13;&#10;begin&#13;&#10;  CalendarStartDate := 0;&#13;&#10;  DayWidth := Engine.PageWidth / 7;&#13;&#10;  if MonthOf(&#60;Months.&#34;FirstDay&#34;&#62; + 35) &#60;&#62; MonthOf(&#60;Months.&#34;FirstDay&#34;&#62; + 7) then&#13;&#10;   Row := 5&#13;&#10;  else&#13;&#10;   Row := 6;&#13;&#10;  DayHeight := (Engine.PageHeight - 140) / Row;&#13;&#10;  DayTaskCount := (DayHeight - 17) div 12;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CalHeaderOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if CalendarStartDate = 0 then&#13;&#10;   CalendarStartDate := &#60;Months.&#34;FirstDay&#34;&#62;&#13;&#10;  else&#13;&#10;  begin              &#13;&#10;   CalendarStartDate := StartOfTheMonth(CalendarStartDate + 42);&#13;&#10;   CalendarStartDate := CalendarStartDate - DayOfWeek(CalendarStartDate - &#60;FirstDayOfWeek&#62; + 5) mod 7;&#13;&#10;  end;             &#13;&#10;end;&#13;&#10;&#13;&#10;procedure CalDayOnAfterData(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  D: TDateTime;&#13;&#10;begin&#13;&#10;  D := CalendarStartDate + &#60;Line&#62; - 1;&#13;&#10;  with TfrxMemoView(Sender) do&#13;&#10;  begin&#13;&#10;   if MonthOf(D) &#60;&#62; MonthOf(CalendarStartDate + 7) then&#13;&#10;    Text := ''&#13;&#10;   else&#13;&#10;   begin&#13;&#10;    Text := IntToStr(DayOf(D));&#13;&#10;    if 1 shl ((DayOfWeek(D) + 5) mod 7) and &#60;WorkDays&#62; = 0 then&#13;&#10;     Font.Color := clRed&#13;&#10;    else&#13;&#10;     Font.Color := clWindowText;&#13;&#10;   end;&#13;&#10;   if (Text &#60;&#62; '') and (TaskCount(D) &#62; 0) then&#13;&#10;    Color := $D0D0D0&#13;&#10;   else&#13;&#10;    Color := clNone;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure WeekDayOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if &#60;Line&#62; = 1 then&#13;&#10;   DayTop := Engine.CurY + 20&#13;&#10;  else&#13;&#10;   Engine.CurY := DayTop - 20;&#13;&#10;  TfrxMemoView(Sender).Left := (&#60;Line&#62; - 1) mod 7 * DayWidth;&#13;&#10;  TfrxMemoView(Sender).Width := DayWidth;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DateOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if (&#60;Line&#62; mod 7 = 1) and (&#60;Line&#62; &#60;&#62; 1) then&#13;&#10;   DayTop := DayTop + DayHeight;&#13;&#10;  Engine.CurY := DayTop;&#13;&#10;  DayLeft := (&#60;Line&#62; - 1) mod 7 * DayWidth;&#13;&#10;  with TfrxMemoView(Sender) do&#13;&#10;  begin&#13;&#10;   Left := DayLeft;&#13;&#10;   Width := DayWidth;&#13;&#10;   if (&#60;Line&#62; = 1) or (StartOfTheMonth(&#60;Days.&#34;Day&#34;&#62;) = &#60;Days.&#34;Day&#34;&#62;) then&#13;&#10;    DisplayFormat.FormatStr := 'd mmmm'&#13;&#10;   else&#13;&#10;    DisplayFormat.FormatStr := 'd';&#13;&#10;   if 1 shl ((DayOfWeek(&#60;Days.&#34;Day&#34;&#62;) + 5) mod 7) and &#60;WorkDays&#62; = 0 then&#13;&#10;    Font.Color := clRed&#13;&#10;   else&#13;&#10;    Font.Color := clWindowText;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure DayOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with TfrxMemoView(Sender) do&#13;&#10;  begin&#13;&#10;   Left := DayLeft;&#13;&#10;   Width := DayWidth;&#13;&#10;   Height := DayHeight - 17;&#13;&#10;   if MonthOf(&#60;Days.&#34;Day&#34;&#62;) &#60;&#62; MonthOf(&#60;Months.&#34;FirstDay&#34;&#62; + 7) then&#13;&#10;    Color := $EEEEEE&#13;&#10;   else&#13;&#10;    Color := clNone;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure TaskOnBeforePrint(Sender: TfrxComponent);&#13;&#10;var&#13;&#10;  X: Integer;&#13;&#10;begin&#13;&#10;  if &#60;Line&#62; = 1 then&#13;&#10;   Engine.CurY := DayTop + 17;&#13;&#10;  with TfrxMemoView(Sender) do&#13;&#10;  begin&#13;&#10;   Visible := &#60;Line&#62; &#60;= DayTaskCount;&#13;&#10;   if &#60;Line&#62; &#62; DayTaskCount then&#13;&#10;    Engine.CurY := DayTop;&#13;&#10;   Left := DayLeft + 2;&#13;&#10;   Width := DayWidth - 4;&#13;&#10;   Color := &#60;DayTasks.&#34;BackgroundColor&#34;&#62;;&#13;&#10;   X := 1;&#13;&#10;   if &#60;DayTasks.&#34;Priority.Img&#34;&#62; &#60;&#62; '' then&#13;&#10;    X := X + 12;&#13;&#10;   if &#60;DayTasks.&#34;Completion.Img&#34;&#62; &#60;&#62; '' then&#13;&#10;    X := X + 11;&#13;&#10;   ParagraphGap := X;&#13;&#10;   if &#60;DayTasks.&#34;AllDay&#34;&#62; then&#13;&#10;   begin&#13;&#10;    Frame.Color := clBlack;&#13;&#10;    Text := '[DayTasks.&#34;Title&#34;]';&#13;&#10;   end&#13;&#10;   else&#13;&#10;   begin&#13;&#10;    Frame.Color := clWindow;&#13;&#10;    Text := '[DayTasks.&#34;CompactTimeStr&#34;] [DayTasks.&#34;Title&#34;]';&#13;&#10;   end;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure PriorityImgOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with TfrxPictureView(Sender) do&#13;&#10;  begin&#13;&#10;   Visible := &#60;Line&#62; &#60;= DayTaskCount;&#13;&#10;   Left := DayLeft + 4;&#13;&#10;   Color := &#60;DayTasks.&#34;BackgroundColor&#34;&#62;;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure CompletionImgOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with TfrxPictureView(Sender) do&#13;&#10;  begin&#13;&#10;   Visible := &#60;Line&#62; &#60;= DayTaskCount;&#13;&#10;   if &#60;DayTasks.&#34;Priority.Img&#34;&#62; = '' then&#13;&#10;    Left := DayLeft + 5&#13;&#10;   else&#13;&#10;    Left := DayLeft + 16;&#13;&#10;   Color := &#60;DayTasks.&#34;BackgroundColor&#34;&#62;;&#13;&#10;  end;&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;end." PropData="044C65667403940003546F70027408446174617365747301010C1500000020446174615365744E616D653D224D6F6E7468732200010C1300000020446174615365744E616D653D22446179732200010C1700000020446174615365744E616D653D224461795461736B73220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="0" RightMargin="81,28" TopMargin="15" BottomMargin="69,167375" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxMasterData Name="MasterData1" Height="115" Left="0" Top="16" Width="815,3202116" OnBeforePrint="CalendarOnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSetName="Months" PrintIfDetailEmpty="True" RowCount="0" StartNewPage="True">
      <TfrxMemoView Name="Memo1" Align="baClient" Left="0" Top="0" Width="815,3202116" Height="115" ShowHint="False" DisplayFormat.FormatStr="mmmm yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="0" Font.Height="-27" Font.Name="Arial" Font.Style="1" Frame.Typ="15" GapX="15" GapY="30" ParentFont="False" Text="[&#60;Months.&#34;FirstDay&#34;&#62;+7]"/>
      <TfrxSubreport Name="Subreport1" Align="baRight" Left="535,3202116" Top="2" Width="140" Height="115" ShowHint="False" Page="Page2" PrintOnParent="True"/>
      <TfrxSubreport Name="Subreport2" Align="baRight" Left="675,3202116" Top="2" Width="140" Height="115" ShowHint="False" Page="Page2" PrintOnParent="True"/>
    </TfrxMasterData>
    <TfrxDetailData Name="DetailData1" Height="0" Left="0" Top="152" Width="815,3202116" ColumnWidth="0" ColumnGap="0" RowCount="1"/>
    <TfrxDetailData Name="DetailData2" Height="20" Left="0" Top="172" Width="815,3202116" ColumnWidth="0" ColumnGap="0" RowCount="7">
      <TfrxMemoView Name="Memo5" Left="0" Top="0" Width="100" Height="20" OnBeforePrint="WeekDayOnBeforePrint" ShowHint="False" DisplayFormat.FormatStr="dddd" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[&#60;Months.&#34;FirstDay&#34;&#62;+&#60;Line&#62;-1]"/>
    </TfrxDetailData>
    <TfrxDetailData Name="DetailData3" Height="60" Left="0" Top="212" Width="815,3202116" ColumnWidth="0" ColumnGap="0" DataSetName="Days" PrintIfDetailEmpty="True" RowCount="0">
      <TfrxMemoView Name="Memo6" Left="0" Top="0" Width="100" Height="17" OnBeforePrint="DateOnBeforePrint" ShowHint="False" DataField="Day" DataSetName="Days" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="1" Frame.Typ="15" GapX="3" ParentFont="False" VAlign="vaCenter" Text="[Days.&#34;Day&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="0" Top="17" Width="100" Height="43" OnBeforePrint="DayOnBeforePrint" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" Frame.Typ="15" LineSpacing="0" ParentFont="False" Text=""/>
    </TfrxDetailData>
    <TfrxSubdetailData Name="SubdetailData1" Height="12" Left="0" Top="292" Width="815,3202116" ColumnWidth="0" ColumnGap="0" DataSetName="DayTasks" RowCount="0">
      <TfrxMemoView Name="Memo8" Left="2" Top="2" Width="96" Height="11" OnBeforePrint="TaskOnBeforePrint" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-8" Font.Name="Arial" Font.Style="0" Frame.Typ="15" LineSpacing="-1" ParentFont="False" WordWrap="False" Text=""/>
      <TfrxPictureView Name="Picture1" Left="4" Top="5" Width="0" Height="12" OnBeforePrint="PriorityImgOnBeforePrint" ShowHint="False" AutoSize="True" Center="True" FileLink="[DayTasks.&#34;Priority.Img&#34;]" Stretched="False" HightQuality="False"/>
      <TfrxPictureView Name="Picture2" Left="18" Top="6" Width="0" Height="8" OnBeforePrint="CompletionImgOnBeforePrint" ShowHint="False" AutoSize="True" Center="True" FileLink="[DayTasks.&#34;Completion.Img&#34;]" Stretched="False" HightQuality="False"/>
    </TfrxSubdetailData>
    <TfrxLineView Name="Line1" Left="0" Top="471,36" Width="816" Height="0" ShowHint="False" Frame.Style="fsDash" Frame.Typ="4" Frame.Width="0,5"/>
    <TfrxLineView Name="Line2" Left="816" Top="-56,6929133858268" Width="0" Height="528" ShowHint="False" Frame.Style="fsDash" Frame.Typ="1" Frame.Width="0,5"/>
    <TfrxMemoView Name="Memo14" Left="328" Top="-34" Width="156" Height="16" ShowHint="False" Font.Charset="1" Font.Color="8421504" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="EssentialPIM Printout"/>
    <TfrxMemoView Name="Memo15" Left="328" Top="-22" Width="156" Height="16" ShowHint="False" Font.Charset="1" Font.Color="8421504" Font.Height="-11" Font.Name="Arial" Font.Style="4" HAlign="haCenter" ParentFont="False" Text="www.essentialpim.com"/>
  </TfrxReportPage>
  <TfrxReportPage Name="Page2" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="0" RightMargin="0" TopMargin="0" BottomMargin="0" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxHeader Name="Header1" Height="15" Left="0" Top="18,89765" Width="793,7013" OnBeforePrint="CalHeaderOnBeforePrint">
      <TfrxMemoView Name="Memo2" Left="0" Top="0" Width="119" Height="14" ShowHint="False" DisplayFormat.FormatStr="mmmm yyyy" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[CalendarStartDate+7]"/>
    </TfrxHeader>
    <TfrxMasterData Name="MasterData2" Height="15" Left="0" Top="56,69295" Width="793,7013" Columns="7" ColumnWidth="17" ColumnGap="0" RowCount="7">
      <TfrxMemoView Name="Memo3" Left="0" Top="0" Width="17" Height="13" ShowHint="False" DisplayFormat.FormatStr="ddd" DisplayFormat.Kind="fkDateTime" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="8" HAlign="haCenter" ParentFont="False" Text="[CalendarStartDate+&#60;Line&#62;-1]"/>
    </TfrxMasterData>
    <TfrxMasterData Name="MasterData3" Height="13" Left="0" Top="94,48825" Width="793,7013" Columns="7" ColumnWidth="17" ColumnGap="0" RowCount="42">
      <TfrxMemoView Name="Memo4" Left="0" Top="0" Width="17" Height="13" OnAfterData="CalDayOnAfterData" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-9" Font.Name="Arial" Font.Style="0" HAlign="haCenter" ParentFont="False" Text=""/>
    </TfrxMasterData>
  </TfrxReportPage>
</TfrxReport>
