-----------------------------------------------------------------------------
【 ソフト名 】 F1ブレイカー version 1.21
【ファイル名】 f1break121.lzh (lh5)
【製作・著作】 Copyright(C) 2005 矢吹拓也
【 動作環境 】 Windows 95/98/Me/NT4.0/2000/XP/Server 2003 (日本語)
-----------------------------------------------------------------------------

 1. はじめに

　　ファイル名の変更をするためにF2キーを押そうとして、F1でヘルプが動き出した。
　　キャンセルをするためにESCキーを押そうとして、F1でヘルプが動き出した。
　　日本語入力をするために半角／全角キーを押そうとして、F1でヘルプが動き出した。
　　ヘルプの動きは緩慢でイライラする！　そんな経験はありませんか？


 2. 何をするプログラムなのか?

　　Windowsのキーボード関連の操作を監視し、F1キーの動きを、動作中のアプリケー
　ションに伝えないようにします。これにより、F1キーによるヘルプの表示を抑止し
　ます。
　　専門的には、アプリケーションがキーボード関連のメッセージの受け取りをする際、
　それがWM_KEYUP／WM_KEYDOWNで、VK_F1に関するものであれば、メッセージの伝達を
　シャットアウトします。
　　なお、F1キー以外のキーについても、ブロックの対象とすることができます。


 3. 動作環境

    Windows 95/98/Me/NT 4.0/2000/XP/Server 2003(日本語版)であれば動きます。
    Windows 3.1(Win32s)以下、Windows NT 3.51以下では動作しません。
　　Windows NT 4.0/2000/XP/Server 2003では、最新のサービスパックを導入してください。
　　このソフトウェアは自称初心者(＝初心者であることを威張り、他の人より多く
　の利益を得ようとする者)の方は利用できません。


 4. インストール方法とファイル構成

　・拡張子lzh(通常圧縮ファイル)

　　これは、単純にすべてのファイルが圧縮されただけのファイルです。
　　ローカルのハードディスクに適当なフォルダを作り、そこへ圧縮された
　すべてのファイルを展開してください。

　　アップデートでインストールする場合は、上書きでインストールして
　しまって構いません。

　　ファイルの構成は、以下のようになっています。

　　F1BREAK.EXE … プログラム本体。
　　F1BREAK.DLL … キーボードフックを行うための補助ライブラリ。
　　F1BREAK.TXT … ドキュメント(このファイル)。
　　F1BREAK.HLP … ヘルプファイル。
　　F1BREAK.CNT … ヘルプの目次。
　　PSAPI.DLL   … Windows NT 4.0でプロセスの調査を行うためのDLL。
　　               マイクロソフト社提供。

　※PSAPI.DLLは、Windows NT 4.0にて使用されます。これは、System32 フォルダへ
　　移動しても構いません。Windows NT 4.0以外のOSでは、削除しても構いません。

　●後から作られるファイル（初めての実行終了時に作られます）

　　F1BREAK.INI … 設定ファイル。記述方は後述。


 5. アンインストール

　　アンインストーラは付属していません。手動でアンインストールを行う必要が
　あります。本ソフトウェアはレジストリを用いていませんので、インストールの際に
　作成したファイルをすべて消せば、アンインストール完了です。


 6. 起動方法

　　F1BREAK.EXEを実行してください。
　　この際、F1BREAK.DLLがカレントディレクトリか、パスの通ったディレクトリに
　配置されていなければなりません。
　　F1BREAK.EXEがすでに起動した状態でさらに起動しようとすると、すでに起動
　しているF1BREAK.EXEを終了することができます。


 7. 基本的な使用方法

　　起動すると、タスクトレイに常駐が開始されます。
　タスクトレイに 「×F1」のアイコンが表示されているときは、F1キー等はブロック
　されています。タスクトレイに「○F1」のアイコンが表示されているときは、F1
　キー等はブロックされていません。
　　「×F1」←→「○F1」の状態遷移は、タスクトレイのアイコンの左クリックで
　行えます。
　　タスクトレイのアイコンを右クリックすると、メニューが表示されます。
　（マウスボタンの入れ替えが行われている場合は、逆となります）
　　メニューの各項目の意味は、以下の通りです。
　　
　　・F1押下禁止（チェック）
　
　　　　F1の押下禁止を設定／解除します。
　　　　タスクトレイのアイコンをクリックするのと同じです。　　
　　
　　・ヘルプの表示
　　
　　　　ヘルプファイルを表示します。
　　　　
　　・設定

　　　　「設定」ダイアログを呼び出します。
　　　　「設定」ダイアログは、各種設定をGUI上で行うためのものです。
　　
　　・バージョン情報
　　
　　　　バージョン情報を表示します。
　　
　　・終了
　　
　　　　このプログラムを終了します。


 8. 設定ファイル(F1BREAK.INI)の記述方

　　設定ファイルのフォーマットは、WindowsのINIファイルの記述方と同じです。

　8.1 [Main] セクション

　　・ShowIcon　（デフォルト：ShowIcon=1）

　　　　タスクトレイにアイコンを表示する場合は 1、しない場合は 0 を指定します。
　　　　なお、ここで 0 を指定すると、タスクトレイのアイコンから、本プログラムの
　　　常駐を解除することができなくなります。この場合、F1BREAK.EXE をもう１つ
　　　起動することで、終了させることができるようになります。

　　・HookKeys　（デフォルト：HookKeys=VK_F1）

　　　　ブロックするキーを指定します。デフォルトでは VK_F1 （F1キーを表す）のみ
　　　が指定されています。記述方は、Windows プログラミングの際に用いられる
　　　仮想キーを指定します（VK_INSERT, VK_SHIFTなど）。A〜Z、0〜9（テンキーでない
　　　キー）に関しては、文字をそのまま入力します（A, Z, 3 等）。文字も割り当て
　　　られていないキーにつては、C言語形式の16進数で指定します（0x40等）。
　　　　複数のキーを指定する場合は、カンマで区切ります。
　　　（記述例:HookKeys=VK_F1,VK_F2,VK_INSERT,G,8,VK_NUMPAD9
　　　　　意味：F1キー、F2キー、Insertキー、Gキー、8キー、テンキーの9キーを、
　　　　　　　　それぞれブロックします）
　　　　なお、￥キーにはそれらしき名前の仮想キーが割り当てられておらず、あて
　　　ずっぽうで色々探してみたところ、VK_OEM_5 でブロックできました。

　　・HookKeysNone　（デフォルト：HookKeyNone=(なし)）

　　　　Shift,Ctrl,Altキーがいずれも離されている時にブロックを行うキーを
　　　指定します。キーの指定方法は、HookKeysと同じです。
　　　　HookKeysとの違いは、HookKeysでは、Shift,Ctrl,Altキーの押下状態に
　　　関わらずブロックするのに対し、Shift,Ctrl,Altキーのすべてが離されて
　　　いる時にのみブロックを行うことです。

　　・HookKeysShift　（デフォルト：HookKeyShift=(なし)）

　　　　Shiftキーが押され、Ctrl,Altキーが離されている時にブロックを行う
　　　キーを指定します。キーの指定方法は、HookKeysと同じです。

　　・HookKeysCtrl　（デフォルト：HookKeyCtrl=(なし)）

　　　　Ctrlキーが押され、Shift,Altキーが離されている時にブロックを行う
　　　キーを指定します。キーの指定方法は、HookKeysと同じです。

　　・HookKeysAlt　（デフォルト：HookKeyAlt=(なし)）

　　　　Altキーが押され、Ctrl,Altキーが離されている時にブロックを行う
　　　キーを指定します。キーの指定方法は、HookKeysと同じです。

　　・HookKeysShiftCtrl　（デフォルト：HookKeyShiftCtrl=(なし)）

　　　　Shift,Ctrlキーが押され、Altキーが離されている時にブロックを行う
　　　キーを指定します。キーの指定方法は、HookKeysと同じです。

　　・HookKeysShiftAlt　（デフォルト：HookKeyShiftAlt=(なし)）

　　　　Shift,Altキーが押され、Ctrlキーが離されている時にブロックを行う
　　　キーを指定します。キーの指定方法は、HookKeysと同じです。

　　・HookKeysCtrlAlt　（デフォルト：HookKeyCtrlAlt=(なし)）

　　　　Ctrl,Altキーが押され、Shiftキーが離されている時にブロックを行う
　　　キーを指定します。キーの指定方法は、HookKeysと同じです。

　　・HookKeysShiftCtrlAlt　（デフォルト：HookKeyShiftCtrlAlt=(なし)）

　　　　Shift,Ctrl,Altキーがいずれも押されている時にブロックを行うキー
　　　を指定します。キーの指定方法は、HookKeysと同じです。


　8.2 [Notify] セクション

　　・Sound　（デフォルト：Sound=1）

　　　　キーのブロックが行われたときに、音を鳴らす場合は 1、鳴らさない場合
　　　は 0 を指定します。

　　・IconChange　（デフォルト：IconChange=1）

　　　　キーのブロックが行われたときに、タスクトレイのアイコンを一瞬だけ変化
　　　させる場合は 1、変化させない場合は 0 を指定します。

　　・SoundFile　（デフォルト：SoundFile=(指定なし)）

　　　　Sound=1のときに鳴らす音のファイルを指定します。
　　　　指定しない場合は、デフォルトの通知音が再生されます。
　　　　
　8.3 [Option] セクション

　　・Exclude　（デフォルト：Exclude=(なし)）

　　　　キーのブロックの対象としないプログラムのファイル名を指定します。
　　　　フォルダ名は省略し、実行ファイルの名称のみを指定します。
　　　　複数のファイル名を指定したいときは、;（セミコロン）で区切ります。
　　　　（例：Exclute=NOTEPAD.EXE;TERAPAD.EXE;MSPAINT.EXE）
　　　　なお、指定できる文字列の長さは、5192文字までです。


 9. 「設定」ダイアログ

　　前項「設定ファイル」にて設定可能な項目の一部を、GUIにて設定するための
　項目です。

　9.1 ブロックするキーの設定

　　　ブロックしたいキーを指定します。
　　　ここでは多くの項目が並んでいますが、そのうちいくつかは、お持ちのキー
　　ボードには存在しないキーである可能性があります（例えば、スリープモード
　　へ入るためのSleepキーは、存在するキーボードと存在しないキーボードがあ
　　ります）。また、いくつかの設定項目は、ブロックするように設定しても、
　　効果のないものがあります（例えば、Windowsの特定のバージョンでないと
　　効果のないキーがあります）。
　　　ここに存在しない項目を指定したい場合は、本プログラムをいったん終了
　　した上で、設定ファイルの [Main] セクション の HookKeys に、仮想キー
　　コードで直接指定してください。
　　　ただし、VK_LSHIFTやVK_RSHIFTなど、指定しても効果のない項目が、いくつ
　　か存在することが確認されていますので、ご注意下さい。
　　　また、VK_LWINやVK_RWIN、Alt+TAB、Ctrl+Alt+Delのように、OSやタスクバー
　　等の標準のアプリケーションが、本ソフトウェアよりも高い優先順位でフック
　　を行っている場合があり、その場合も実質的には効果がないことになりますの
　　でご注意下さい。

　　　修飾キーについては、以下の通りになります。

　　　・関知しない ……… Shift,Ctrl,Altの各キーの押下状態に関わらず、
　　　　　　　　　　　　　キーのブロックを行うキーを指定します。
　　　・なし　　　 ……… Shift,Ctrl,Altキーがいずれも離されている時に
　　　　　　　　　　　　　ブロックを行うキーを指定します。
　　　・Shift 　　 ……… Shiftキーが押され、Ctrl,Altキーが離されてい
　　　　　　　　　　　　　る時にブロックを行うキーを指定します。
　　　・Ctrl 　　　……… Ctrlキーが押され、Shift,Altキーが離されてい
　　　　　　　　　　　　　る時にブロックを行うキーを指定します。
　　　・Alt  　　　……… Altキーが押され、Shift,Ctrlキーが離されてい
　　　　　　　　　　　　　る時にブロックを行うキーを指定します。
　　　・Shift+Ctrl ……… ShiftとCtrlキーが押され、Altキーが離されて
　　　　　　　　　　　　　いる時にブロックを行うキーを指定します。
　　　・Ctrl+Alt   ……… CtrlとAltキーが押され、Shiftキーが離されて
　　　　　　　　　　　　　いる時にブロックを行うキーを指定します。
　　　・Shift+Alt  ……… ShiftとAltキーが押され、Ctrlキーが離されて
　　　　　　　　　　　　　いる時にブロックを行うキーを指定します。
　　　・Shift+Ctrl+Alt … ShiftとCtrlとAltキーがいずれも押されている
　　　　　　　　　　　　　時にブロックを行うキーを指定します。
　　　

　9.2 通知方法

　　　・音を鳴らして知らせる（デフォルト：オン）

　　　　　キーのブロックが行われたときに、音を鳴らします。

　　　・再生テスト（ボタン）

　　　　　キーのブロックが行われたときに鳴る音を再生します。

　　　・音声ファイルの指定（デフォルト：なし）

　　　　　音を鳴らして知らせる場合に再生する音声ファイルを指定します。
　　　　　音声ファイルを指定しない場合、デフォルトの通知音が再生されます。

　　　・参照（ボタン）

　　　　　音声ファイルを一覧から選択できます。
　　　　　なお、ファイルをこのダイアログへドラッグ＆ドロップすることも
　　　　できます。

　　　・アイコンを変化させて知らせる（デフォルト：オン）

　　　　　キーのブロックが行われたときに、システムトレイ内のアイコンを
　　　　一瞬だけ変化させます。

　　　・OK（ボタン）

　　　　　設定した内容を有効にして、このダイアログを閉じます。

　　　・キャンセル（ボタン）

　　　　　設定した内容を有効にせず、このダイアログを閉じます。
　　　　　
　　　　　
　9.3 除外するプログラムの指定

　　　・キー抑止から除外するプログラムの指定（デフォルト：なし）

　　　　　キーのブロックの対象としないプログラムのファイル名を指定します。
　　　　　フォルダ名は省略し、実行ファイルの名称のみを指定します。
　　　　　複数のファイル名を指定したいときは、;（セミコロン）で区切ります。
　　　　　（例：NOTEPAD.EXE;TERAPAD.EXE;MSPAINT.EXE）
　　　　　なお、指定できる文字列の長さは、5192文字までです。


　　なお、設定内容が設定ファイルへ保存されるのは、このプログラムが終了される
　ときです。

　　システムトレイ内のアイコンを表示させないようにするには、本プログラムを
　いったん終了させて、F1Break.exeと同一フォルダ内にあるF1Break.iniを編集し、
　[Main]セクションのShowIcon=1をShowIcon=0に書き換えます。


 10. 注意

　　このプログラムは、キーボードメッセージをフックすることにより、F1キー等の
　抑止を実現しています。そのため、以下のようなソフトウェアについては、以下の
　ような特殊な手段によりキー状態を取得するソフトウェアについては、抑止の対象
　となりませんのでご注意下さい。

　・キー状態を自ら参照しに行くソフトウェア
　・Visual Studio 6.0
　・DirectInput を用いるようなゲーム等
　・タスクバー／シェル／OS
　・本プログラムよりも低レベルで、あるいは、早い段階でフックを行っているプログラム


 11. 著作権・転載について

　　本プログラムはフリーソフトです。著作権は 矢吹拓也 にあります。
　　本プログラムを使用した際に生じたいかなる障害についても、またドキュメント
　ファイル等に不手際があったとしても、著作権所有者は一切の責任を負わないもの
　とします。

　　このソフトウェアは、ユーザーが自称初心者(＝初心者であることを威張り、他
　の人より多くの利益を得ようとする者)である場合は利用できません。自称初心者
　の方のご利用はお控えいただきますよう、お願いします。従いまして、自称初心者
　の方が初心者であるが故に起こした事故、または自称初心者であるが故の質問など
　は一切受け付けませんので、予めご了承ください。

　　このプログラムは再配布可能[*]です。これには、他のネットワーク、インター
　ネット上の他のサイトへの転載、雑誌の付属メディアへの掲載・収録も含まれま
　す。詳しくは、INASOFTのWebサイトを参照してください。

　[*] 最も新しい正式版の再配布をしていただきますよう、ご協力をお願いします。
　　  開発途中のバージョン(tr/α/pp/pr/β/fb/rc等)の再配布をしてはいけません。
　　　開発途中のバージョンが雑誌等の付属メディアに収録されてしまった場合、出
　　　版社の全負担で回収していただくことになりますのでご注意ください。

　　ニュースサイトや更新情報を扱うサイト、個人サイトなどでの紹介などで
　アイコンや実行画面を使われる場合も、連絡なしで構いません。

　　プログラム中になんらかのバグが見つかったり、ドキュメント中にミスがあった
　場合は、メールなどで知らせていただけるとありがたいです。

　　配布・転載・収録するときは、すべてのファイルを一切改変しない状態で行って
　下さい(アーカイブ形式の変更は構いません)。


 12. 質問をお寄せになる場合の注意

　　質問をお寄せになる前に、ご質問の内容が本ソフトウェアと無関係のものでない
　かをご確認ください。ご協力をお願いします。


※PSAPI.DLLは、Windows NT 4.0でプロセスの調査を行うための、マイクロソフト社
　提供のDLLです。
※Windows、Windows NTは米国Microsoft Corporationの米国およびその他の国におけ
　る登録商標です。
※その他記載されている会社名、製品名などは、各社の登録商標もしくは商標です。
※本ソフトウェアを利用される方がお使いになるPCに、ウイルス対策が施されている
　ことを確認してください。ウイルス対策が施されていない場合、本ソフトウェアを
　利用してはいけません。また、質問も受け付けません。

-----------------------------------------------------------------------------
 [INASOFT] http://www.yoshibaworks.com/ayacy/inasoft/
           http://park21.wakwak.com/~ayacy/inasoft/
 [eメール] 右クリック - バージョン情報をご覧になるか、Webサイトをご覧下さい。
